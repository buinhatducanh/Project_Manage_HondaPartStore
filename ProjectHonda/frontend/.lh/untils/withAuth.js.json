{
    "sourceFile": "untils/withAuth.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1739377950834,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1739377950834,
            "name": "Commit-0",
            "content": "import { useEffect } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\n\r\nconst withAuth = (WrappedComponent, allowedRoles) => {\r\n  return (props) => {\r\n    const router = useRouter();\r\n    const user = typeof window !== \"undefined\" ? JSON.parse(localStorage.getItem(\"user\")) : null;\r\n\r\n    useEffect(() => {\r\n      if (!user || !allowedRoles.includes(user.role)) {\r\n        router.push(\"/login\");\r\n      }\r\n    }, [user, router]);\r\n\r\n    if (!user || !allowedRoles.includes(user.role)) {\r\n      return null; // Chặn hiển thị UI khi chưa xác thực\r\n    }\r\n\r\n    return <WrappedComponent {...props} />;\r\n  };\r\n};\r\n\r\nexport default withAuth;\r\n"
        }
    ]
}